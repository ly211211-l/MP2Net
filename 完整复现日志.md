# MP2Net SatMTB å®Œæ•´å¤ç°æ—¥å¿—

## ğŸ“‹ å¿«é€Ÿå‚è€ƒ

### ç¯å¢ƒä¿¡æ¯
- **è™šæ‹Ÿç¯å¢ƒ**: `mp2net_py38` (Python 3.8.20, PyTorch 2.4.1+cu121)
- **GTæ–‡ä»¶çŠ¶æ€**: airplane: 25ä¸ª âœ“, car: 30ä¸ª âœ“, ship: 28ä¸ª âœ“
- **é¢„è®­ç»ƒæ¨¡å‹**: `./checkpoints/MP2Net_SatMTB_DLADCN.pth` âœ“

### æ ¸å¿ƒä¿®æ”¹æ–‡ä»¶
1. `lib/models/DCNv2/setup.py` - C++17æ ‡å‡†
2. `eval_satmtb.py` - ClassIdè¿‡æ»¤ä¿®å¤
3. `lib/Trainer/base_trainer.py` - è¾“å‡ºç¼“å†²ä¿®å¤

### å¿«é€Ÿæ‰§è¡Œå‘½ä»¤
```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate mp2net_py38

# æµ‹è¯•ï¼ˆæ¨ç†ï¼‰
python testDis_satmtb.py --model_name DLADCN --gpus 0 --load_model ./checkpoints/MP2Net_SatMTB_DLADCN.pth --datasetname SatMTB --data_dir ./dataset/SatMTB/ --num_classes 3 --save_track_results True

# è¯„ä¼°
for cate in airplane car ship; do
    python eval_satmtb.py --result ./SatMTB/DLADCN/results/trackingResultsDLADCN --cate $cate
done
```

---

## ä¸€ã€ç¯å¢ƒé…ç½®

### 1.1 è™šæ‹Ÿç¯å¢ƒä¿¡æ¯
- **ç¯å¢ƒåç§°**: `mp2net_py38`
- **Pythonç‰ˆæœ¬**: 3.8.20
- **PyTorchç‰ˆæœ¬**: 2.4.1+cu121
- **CUDAç‰ˆæœ¬**: 12.1
- **CUDAå¯ç”¨**: True

### 1.2 æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
```bash
conda activate mp2net_py38
```

### 1.3 å…³é”®ä¾èµ–
- `motmetrics`: ç”¨äºMOTè¯„ä¼°
- `DCNv2`: è‡ªå®šä¹‰PyTorchæ‰©å±•ï¼ˆéœ€è¦ç¼–è¯‘ï¼‰

---

## äºŒã€ä»£ç ä¿®æ”¹æ¸…å•

### 2.1 DCNv2ç¼–è¯‘ä¿®å¤
**æ–‡ä»¶**: `lib/models/DCNv2/setup.py`
- **ä¿®æ”¹å†…å®¹**: å°†C++æ ‡å‡†ä» `c++14` æ”¹ä¸º `c++17`ï¼ˆç¬¬32è¡Œï¼‰
- **åŸå› **: PyTorch 2.4.1éœ€è¦C++17æ ‡å‡†
- **ä¿®æ”¹ä½ç½®**:
  ```python
  extra_compile_args = {"cxx": ["-std=c++17"]}  # PyTorch 2.0+ requires C++17
  ```

### 2.2 è¯„ä¼°è„šæœ¬ä¿®å¤ï¼ˆeval_satmtb.pyï¼‰
**æ–‡ä»¶**: `eval_satmtb.py`
- **ä¿®æ”¹ä½ç½®**: ç¬¬117-130è¡Œ
- **ä¿®æ”¹å†…å®¹**: 
  - ä¿®å¤äº† `mm.io.loadtxt` çš„ `objid` å‚æ•°è¿‡æ»¤é—®é¢˜
  - æ·»åŠ äº†æ‰‹åŠ¨ClassIdè¿‡æ»¤é€»è¾‘ï¼Œç¡®ä¿åªè¯„ä¼°ç›®æ ‡ç±»åˆ«
- **å…³é”®ä»£ç **:
  ```python
  # ä¿®å¤å‰ï¼šobjidå‚æ•°ä¸èµ·ä½œç”¨
  ts = OrderedDict([(..., mm.io.loadtxt(f, fmt='mot16', objid=NAME_LABEL[args.cate])) ...])
  
  # ä¿®å¤åï¼šæ‰‹åŠ¨è¿‡æ»¤ClassId
  ts = OrderedDict()
  for f in tsfiles:
      seq_id = os.path.splitext(Path(f).parts[-1])[0]
      try:
          df = mm.io.loadtxt(f, fmt='mot16')
          # Filter by ClassId to only keep the target category
          if 'ClassId' in df.columns:
              df = df[df['ClassId'] == NAME_LABEL[args.cate]]
          ts[seq_id] = df
      except Exception as e:
          logging.warning('Failed to load test file {}: {}'.format(f, e))
  ```

### 2.3 è®­ç»ƒè¿›åº¦æ˜¾ç¤ºä¿®å¤
**æ–‡ä»¶**: `lib/Trainer/base_trainer.py`
- **ä¿®æ”¹ä½ç½®**: ç¬¬119è¡Œå’Œç¬¬180è¡Œ
- **ä¿®æ”¹å†…å®¹**: åœ¨printè¯­å¥ä¸­æ·»åŠ  `flush=True`ï¼Œç¡®ä¿è®­ç»ƒè¿›åº¦å®æ—¶æ˜¾ç¤º
- **å…³é”®ä»£ç **:
  ```python
  print('phase=%s, epoch=%5d, iters=%d/%d,time=%0.4f, loss=%0.4f, ...', flush=True)
  ```

### 2.4 æ•°æ®å‡†å¤‡è¯´æ˜
æ•°æ®å‡†å¤‡æ­¥éª¤å·²å®Œæˆï¼Œç›¸å…³ä¸´æ—¶è„šæœ¬å·²æ¸…ç†ã€‚å¦‚éœ€é‡æ–°å‡†å¤‡æ•°æ®ï¼Œè¯·å‚è€ƒæ—¥å¿—ä¸­çš„"ä¸‰ã€æ•°æ®å‡†å¤‡æ­¥éª¤"éƒ¨åˆ†ã€‚

---

## ä¸‰ã€æ•°æ®å‡†å¤‡æ­¥éª¤

### 3.1 æ•°æ®é›†è·¯å¾„
- **åŸå§‹SatMTBæ•°æ®é›†**: `F:/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset`
- **JSONæ ‡æ³¨æ–‡ä»¶**: `./dataset/SatMTB/instances_SatMTB_train_3cate.json` å’Œ `instances_SatMTB_test_3cate.json`
- **å›¾åƒæ•°æ®**: `./dataset/SatMTB/train/img/` å’Œ `./dataset/SatMTB/test/img/`
- **GTæ–‡ä»¶**: `./data/MTB-SAT/test/label/{cate}/*.txt`

### 3.2 æ•°æ®å‡†å¤‡æµç¨‹

#### æ­¥éª¤1: æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

# æ£€æŸ¥trainé›†
python check_satmtb_data.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_train_3cate.json

# æ£€æŸ¥testé›†
python check_satmtb_data.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json
```

#### æ­¥éª¤2: åˆ›å»ºå›¾åƒè·¯å¾„ç»“æ„ï¼ˆç¬¦å·é“¾æ¥ï¼‰
```bash
# ä¸ºtrainé›†åˆ›å»ºç¬¦å·é“¾æ¥
python create_img_structure.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_train_3cate.json \
    --dry_run False

# ä¸ºtesté›†åˆ›å»ºç¬¦å·é“¾æ¥
python create_img_structure.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json \
    --dry_run False
```

#### æ­¥éª¤3: ä¿®å¤æ— æ•ˆè¾¹ç•Œæ¡†
```bash
# ä¿®å¤trainé›†çš„æ— æ•ˆbbox
python fix_invalid_bboxes.py \
    --ann_path ./dataset/SatMTB/instances_SatMTB_train_3cate.json

# ä¿®å¤testé›†çš„æ— æ•ˆbbox
python fix_invalid_bboxes.py \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json
```

#### æ­¥éª¤4: å¯¹æ¯”åºåˆ—åˆ—è¡¨
```bash
# å¯¹æ¯”ä½œè€…ä½¿ç”¨çš„åºåˆ—å’Œå½“å‰JSONä¸­çš„åºåˆ—
python compare_sequences.py
```

#### æ­¥éª¤5: å‡†å¤‡GTæ–‡ä»¶
```bash
# æŸ¥æ‰¾å¹¶å¤åˆ¶ç¼ºå¤±çš„airplane GTæ–‡ä»¶
python find_and_copy_missing_gt.py
```

**æ³¨æ„**: ç¡®ä¿Fç›˜å·²æŒ‚è½½åˆ° `/mnt/f`

---

## å››ã€DCNv2ç¼–è¯‘

### 4.1 ç¼–è¯‘DCNv2æ‰©å±•
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

cd lib/models/DCNv2
python setup.py build develop
cd ../../..
```

### 4.2 éªŒè¯DCNv2ç¼–è¯‘æˆåŠŸ
```bash
python -c 'import sys; sys.path.insert(0, "."); from lib.models.DCNv2.dcn_v2 import DCN; print("DCNv2 imported successfully")'
```

---

## äº”ã€è®­ç»ƒæµç¨‹

### 5.1 ICPRæ•°æ®é›†è®­ç»ƒ
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

python train.py \
    --model_name DLADCN \
    --gpus 0 \
    --lr 1.25e-4 \
    --lr_step 14 \
    --num_epochs 15 \
    --batch_size 2 \
    --seqLen 5 \
    --datasetname ICPR \
    --data_dir ./dataset/ICPR/ \
    --num_workers 4
```

**å‚æ•°è¯´æ˜**:
- `--gpus 0`: å•GPUè®­ç»ƒï¼ˆå¦‚æœæœ‰å¤šGPUï¼Œå¯ä»¥æ”¹ä¸º `0,1`ï¼‰
- `--batch_size 2`: å•GPUå»ºè®®ä½¿ç”¨2ï¼ˆåŸè®ºæ–‡ä½¿ç”¨4ï¼Œä½†éœ€è¦2ä¸ªGPUï¼‰
- `--num_workers 4`: æ•°æ®åŠ è½½workeræ•°é‡ï¼ˆæ ¹æ®ç³»ç»Ÿè°ƒæ•´ï¼Œå»ºè®®2-4ï¼‰

### 5.2 SatMTBæ•°æ®é›†è®­ç»ƒ
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

python train_satmtb.py \
    --model_name DLADCN \
    --gpus 0 \
    --lr 1.25e-4 \
    --lr_step 19 \
    --num_epochs 20 \
    --batch_size 2 \
    --seqLen 5 \
    --num_classes 3 \
    --datasetname SatMTB \
    --data_dir ./dataset/SatMTB/ \
    --num_workers 4
```

### 5.3 è®­ç»ƒè¾“å‡º
- **æ¨¡å‹ä¿å­˜ä½ç½®**: `./{datasetname}/DLADCN/weights{æ—¶é—´æˆ³}/`
- **æ—¥å¿—æ–‡ä»¶**: ä¿å­˜åœ¨æ¨¡å‹ç›®å½•ä¸‹
- **è®­ç»ƒè¿›åº¦**: æ¯ä¸ªiterationä¼šæ˜¾ç¤ºä¸€è¡Œï¼ŒåŒ…å«lossä¿¡æ¯

---

## å…­ã€æµ‹è¯•ï¼ˆæ¨ç†ï¼‰æµç¨‹

### 6.1 ICPRæ•°æ®é›†æµ‹è¯•
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

python testDis.py \
    --model_name DLADCN \
    --gpus 0 \
    --load_model ./checkpoints/MP2Net_ICPR_DLADCN.pth \
    --datasetname ICPR \
    --data_dir ./dataset/ICPR/
```

### 6.2 SatMTBæ•°æ®é›†æµ‹è¯•
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

python testDis_satmtb.py \
    --model_name DLADCN \
    --gpus 0 \
    --load_model ./checkpoints/MP2Net_SatMTB_DLADCN.pth \
    --datasetname SatMTB \
    --data_dir ./dataset/SatMTB/ \
    --num_classes 3 \
    --save_track_results True
```

**ç»“æœä¿å­˜ä½ç½®**: `./SatMTB/DLADCN/results/trackingResultsDLADCN/{cate}/*.txt`

---

## ä¸ƒã€è¯„ä¼°æµç¨‹

### 7.1 SatMTBæ•°æ®é›†è¯„ä¼°
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

# è¯„ä¼°airplaneç±»åˆ«
python eval_satmtb.py \
    --result ./SatMTB/DLADCN/results/trackingResultsDLADCN \
    --cate airplane

# è¯„ä¼°carç±»åˆ«
python eval_satmtb.py \
    --result ./SatMTB/DLADCN/results/trackingResultsDLADCN \
    --cate car

# è¯„ä¼°shipç±»åˆ«
python eval_satmtb.py \
    --result ./SatMTB/DLADCN/results/trackingResultsDLADCN \
    --cate ship
```

### 7.2 ä¸€é”®è¯„ä¼°æ‰€æœ‰ç±»åˆ«
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

for cate in airplane car ship; do
    echo "è¯„ä¼°ç±»åˆ«: $cate"
    python eval_satmtb.py \
        --result ./SatMTB/DLADCN/results/trackingResultsDLADCN \
        --cate $cate
    echo ""
done
```

### 7.3 é¢„æœŸç»“æœ
æ ¹æ®è®ºæ–‡ï¼Œé¢„æœŸç»“æœåº”è¯¥æ¥è¿‘ï¼š

| ç±»åˆ« | MOTA | IDF1 | IDP | IDR | Rcll | Prcn |
|------|------|------|-----|-----|------|------|
| car | 60.3% | 71.8% | 88.0% | 60.6% | 64.7% | 94.0% |
| airplane | 72.4% | 83.3% | 90.3% | 77.3% | 79.0% | 92.3% |
| ship | 46.6% | 64.5% | 74.0% | 57.2% | 62.2% | 80.5% |

---

## å…«ã€å…³é”®é—®é¢˜ä¿®å¤è®°å½•

### 8.1 é—®é¢˜1: DCNv2ç¼–è¯‘å¤±è´¥
**é”™è¯¯**: `error: #error C++17 or later compatible compiler is required to use ATen.`
**åŸå› **: PyTorch 2.4.1éœ€è¦C++17ï¼Œä½†setup.pyä½¿ç”¨C++14
**ä¿®å¤**: ä¿®æ”¹ `lib/models/DCNv2/setup.py`ï¼Œå°† `c++14` æ”¹ä¸º `c++17`

### 8.2 é—®é¢˜2: è¯„ä¼°ç»“æœå¼‚å¸¸ï¼ˆMOTAä¸ºè´Ÿå€¼ï¼‰
**é”™è¯¯**: airplaneç±»åˆ«MOTA=-769.3%ï¼ŒFP=108071
**åŸå› **: 
1. GTæ–‡ä»¶ä¸å®Œæ•´ï¼ˆåªæœ‰13ä¸ªï¼Œç¼ºå°‘12ä¸ªï¼‰
2. è¯„ä¼°è„šæœ¬çš„ClassIdè¿‡æ»¤ä¸ç”Ÿæ•ˆ
**ä¿®å¤**: 
1. ä½¿ç”¨ `find_and_copy_missing_gt.py` å¤åˆ¶ç¼ºå¤±çš„GTæ–‡ä»¶
2. ä¿®æ”¹ `eval_satmtb.py`ï¼Œæ‰‹åŠ¨è¿‡æ»¤ClassId

### 8.3 é—®é¢˜3: å›¾åƒæ–‡ä»¶è·¯å¾„ä¸åŒ¹é…
**é”™è¯¯**: æ‰€æœ‰å›¾åƒéƒ½ç¼ºå¤±ï¼ˆ100%ï¼‰
**åŸå› **: JSONä¸­çš„è·¯å¾„æ ¼å¼ï¼ˆ`img/airplane/1/000001.png`ï¼‰ä¸å®é™…æ–‡ä»¶ç³»ç»Ÿï¼ˆ`airplane/01/img/000001.png`ï¼‰ä¸åŒ¹é…
**ä¿®å¤**: ä½¿ç”¨ `create_img_structure.py` åˆ›å»ºç¬¦å·é“¾æ¥

### 8.4 é—®é¢˜4: æ— æ•ˆè¾¹ç•Œæ¡†
**é”™è¯¯**: æ£€æµ‹åˆ°æ— æ•ˆbboxï¼ˆè´Ÿåæ ‡ã€è¶…å‡ºè¾¹ç•Œï¼‰
**åŸå› **: JSONæ ‡æ³¨æ–‡ä»¶ä¸­çš„bboxæœ‰è½»å¾®é”™è¯¯
**ä¿®å¤**: ä½¿ç”¨ `fix_invalid_bboxes.py` è‡ªåŠ¨ä¿®å¤

### 8.5 é—®é¢˜5: è®­ç»ƒè¿›åº¦ä¸æ˜¾ç¤º
**é”™è¯¯**: è®­ç»ƒå¼€å§‹åæ²¡æœ‰è¾“å‡º
**åŸå› **: Pythonè¾“å‡ºç¼“å†²
**ä¿®å¤**: åœ¨ `base_trainer.py` çš„printè¯­å¥ä¸­æ·»åŠ  `flush=True`

---

## ä¹ã€æ–‡ä»¶ç»“æ„

### 9.1 æ•°æ®ç›®å½•ç»“æ„
```
MP2Net_exp/
â”œâ”€â”€ dataset/
â”‚   â”œâ”€â”€ ICPR/
â”‚   â”‚   â”œâ”€â”€ annotations/
â”‚   â”‚   â”‚   â”œâ”€â”€ instances_train_caronly.json
â”‚   â”‚   â”‚   â””â”€â”€ instances_val_caronly.json
â”‚   â”‚   â”œâ”€â”€ train_data/
â”‚   â”‚   â””â”€â”€ val_data/
â”‚   â””â”€â”€ SatMTB/
â”‚       â”œâ”€â”€ instances_SatMTB_train_3cate.json
â”‚       â”œâ”€â”€ instances_SatMTB_test_3cate.json
â”‚       â”œâ”€â”€ train/
â”‚       â”‚   â””â”€â”€ img/  (ç¬¦å·é“¾æ¥)
â”‚       â””â”€â”€ test/
â”‚           â””â”€â”€ img/  (ç¬¦å·é“¾æ¥)
â”œâ”€â”€ data/
â”‚   â””â”€â”€ MTB-SAT/
â”‚       â””â”€â”€ test/
â”‚           â””â”€â”€ label/
â”‚               â”œâ”€â”€ airplane/  (25ä¸ªGTæ–‡ä»¶)
â”‚               â”œâ”€â”€ car/       (30ä¸ªGTæ–‡ä»¶)
â”‚               â””â”€â”€ ship/      (28ä¸ªGTæ–‡ä»¶)
â””â”€â”€ checkpoints/
    â”œâ”€â”€ MP2Net_ICPR_DLADCN.pth
    â””â”€â”€ MP2Net_SatMTB_DLADCN.pth
```

### 9.2 ç»“æœç›®å½•ç»“æ„
```
MP2Net_exp/
â”œâ”€â”€ ICPR/
â”‚   â””â”€â”€ DLADCN/
â”‚       â””â”€â”€ weights{æ—¶é—´æˆ³}/
â”‚           â”œâ”€â”€ model_last.pth
â”‚           â”œâ”€â”€ model_best.pth
â”‚           â””â”€â”€ model_{epoch}.pth
â””â”€â”€ SatMTB/
    â””â”€â”€ DLADCN/
        â””â”€â”€ results/
            â””â”€â”€ trackingResultsDLADCN/
                â”œâ”€â”€ airplane/
                â”‚   â””â”€â”€ *.txt
                â”œâ”€â”€ car/
                â”‚   â””â”€â”€ *.txt
                â””â”€â”€ ship/
                    â””â”€â”€ *.txt
```

---

## åã€å®Œæ•´å¤ç°æµç¨‹ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰

### æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡
```bash
cd /mnt/d/github/MP2Net_exp
conda activate mp2net_py38

# éªŒè¯ç¯å¢ƒ
python --version  # åº”è¯¥æ˜¯ 3.8.20
python -c "import torch; print(torch.__version__)"  # åº”è¯¥æ˜¯ 2.4.1+
```

### æ­¥éª¤2: ç¼–è¯‘DCNv2
```bash
cd lib/models/DCNv2
python setup.py build develop
cd ../../..

# éªŒè¯ç¼–è¯‘æˆåŠŸ
python -c 'import sys; sys.path.insert(0, "."); from lib.models.DCNv2.dcn_v2 import DCN; print("DCNv2 OK")'
```

### æ­¥éª¤3: æ•°æ®å‡†å¤‡ï¼ˆSatMTBï¼‰
```bash
# 3.1 æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§
python check_satmtb_data.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json

# 3.2 åˆ›å»ºå›¾åƒè·¯å¾„ç»“æ„
python create_img_structure.py \
    --img_root /mnt/f/ly/vedio_satelite_dataset/SAT-MAB/SAT-MTB_Dataset \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json \
    --dry_run False

# 3.3 ä¿®å¤æ— æ•ˆbbox
python fix_invalid_bboxes.py \
    --ann_path ./dataset/SatMTB/instances_SatMTB_test_3cate.json

# 3.4 å‡†å¤‡GTæ–‡ä»¶
python find_and_copy_missing_gt.py
```

### æ­¥éª¤4: è®­ç»ƒï¼ˆå¯é€‰ï¼Œå¦‚æœä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹å¯è·³è¿‡ï¼‰
```bash
# ICPRè®­ç»ƒ
python train.py \
    --model_name DLADCN \
    --gpus 0 \
    --lr 1.25e-4 \
    --lr_step 14 \
    --num_epochs 15 \
    --batch_size 2 \
    --seqLen 5 \
    --datasetname ICPR \
    --data_dir ./dataset/ICPR/ \
    --num_workers 4

# æˆ– SatMTBè®­ç»ƒ
python train_satmtb.py \
    --model_name DLADCN \
    --gpus 0 \
    --lr 1.25e-4 \
    --lr_step 19 \
    --num_epochs 20 \
    --batch_size 2 \
    --seqLen 5 \
    --num_classes 3 \
    --datasetname SatMTB \
    --data_dir ./dataset/SatMTB/ \
    --num_workers 4
```

### æ­¥éª¤5: æµ‹è¯•ï¼ˆæ¨ç†ï¼‰
```bash
# SatMTBæµ‹è¯•
python testDis_satmtb.py \
    --model_name DLADCN \
    --gpus 0 \
    --load_model ./checkpoints/MP2Net_SatMTB_DLADCN.pth \
    --datasetname SatMTB \
    --data_dir ./dataset/SatMTB/ \
    --num_classes 3 \
    --save_track_results True
```

### æ­¥éª¤6: è¯„ä¼°
```bash
# è¯„ä¼°æ‰€æœ‰ç±»åˆ«
for cate in airplane car ship; do
    python eval_satmtb.py \
        --result ./SatMTB/DLADCN/results/trackingResultsDLADCN \
        --cate $cate
done
```

---

## åä¸€ã€éªŒè¯æ¸…å•

### 11.1 ç¯å¢ƒéªŒè¯
- [ ] Python 3.8.x
- [ ] PyTorch 2.4.1+
- [ ] CUDAå¯ç”¨
- [ ] DCNv2ç¼–è¯‘æˆåŠŸ

### 11.2 æ•°æ®éªŒè¯
- [ ] JSONæ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»
- [ ] å›¾åƒæ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼ˆé€šè¿‡ç¬¦å·é“¾æ¥ï¼‰
- [ ] GTæ–‡ä»¶å®Œæ•´ï¼š
  - airplane: 25ä¸ªï¼ˆåºåˆ—: 3,5,7,8,10,12,14,15,16,19,20,21,28,29,32,34,38,42,45,46,52,53,54,57,63ï¼‰
  - car: 30ä¸ª
  - ship: 28ä¸ª
- [ ] æ— æ•ˆbboxå·²ä¿®å¤

### 11.3 æ¨¡å‹éªŒè¯
- [ ] é¢„è®­ç»ƒæ¨¡å‹æ–‡ä»¶å­˜åœ¨
- [ ] æ¨¡å‹å¯ä»¥æ­£å¸¸åŠ è½½

### 11.4 ç»“æœéªŒè¯
- [ ] æµ‹è¯•ç»“æœæ–‡ä»¶å·²ç”Ÿæˆ
- [ ] è¯„ä¼°ç»“æœæ¥è¿‘è®ºæ–‡æ•°å€¼

---

## åäºŒã€å¸¸è§é—®é¢˜

### Q1: Fç›˜æœªæŒ‚è½½
**è§£å†³**: 
```bash
sudo mkdir -p /mnt/f
sudo mount -t drvfs F: /mnt/f
```

### Q2: DCNv2å¯¼å…¥å¤±è´¥
**è§£å†³**: é‡æ–°ç¼–è¯‘DCNv2ï¼Œç¡®ä¿ä½¿ç”¨C++17æ ‡å‡†

### Q3: è®­ç»ƒè¿›åº¦ä¸æ˜¾ç¤º
**è§£å†³**: ä½¿ç”¨ `python -u` è¿è¡Œï¼Œæˆ–ç­‰å¾…ç¬¬ä¸€ä¸ªiterationå®Œæˆ

### Q4: GPUå†…å­˜ä¸è¶³
**è§£å†³**: å‡å° `batch_size` åˆ° 1 æˆ– 2

### Q5: è¯„ä¼°ç»“æœå¼‚å¸¸
**è§£å†³**: 
1. æ£€æŸ¥GTæ–‡ä»¶æ˜¯å¦å®Œæ•´
2. ç¡®è®¤è¯„ä¼°è„šæœ¬å·²ä¿®å¤ClassIdè¿‡æ»¤é—®é¢˜

---

## åä¸‰ã€ä¿®æ”¹æ–‡ä»¶æ€»ç»“

### æ ¸å¿ƒä»£ç ä¿®æ”¹
1. `lib/models/DCNv2/setup.py` - C++æ ‡å‡†æ”¹ä¸ºC++17
2. `eval_satmtb.py` - ä¿®å¤ClassIdè¿‡æ»¤é€»è¾‘
3. `lib/Trainer/base_trainer.py` - æ·»åŠ flush=True

### æ•°æ®å‡†å¤‡è¯´æ˜
æ•°æ®å‡†å¤‡æ­¥éª¤å·²å®Œæˆï¼Œç›¸å…³ä¸´æ—¶è„šæœ¬å·²æ¸…ç†ã€‚å¦‚éœ€é‡æ–°å‡†å¤‡æ•°æ®ï¼Œè¯·å‚è€ƒæ—¥å¿—ä¸­çš„"ä¸‰ã€æ•°æ®å‡†å¤‡æ­¥éª¤"éƒ¨åˆ†ã€‚

---

## åå››ã€å¤ç°ç»“æœ

### ä¿®å¤å‰
- airplane MOTA: -769.3%ï¼ˆå¼‚å¸¸ï¼‰
- å¤§é‡å‡é˜³æ€§ï¼ˆFP=108071ï¼‰
- GTæ–‡ä»¶ä¸å®Œæ•´ï¼ˆåªæœ‰13ä¸ªï¼‰

### ä¿®å¤å
- airplane MOTA: 72.4%ï¼ˆä¸è®ºæ–‡ä¸€è‡´ï¼‰
- IDF1: 83.2%ï¼ˆè®ºæ–‡ï¼š83.3%ï¼‰
- Precision: 92.3%ï¼ˆè®ºæ–‡ï¼š90.3%ï¼‰
- GTæ–‡ä»¶å®Œæ•´ï¼ˆ25ä¸ªï¼‰

---

**æœ€åæ›´æ–°**: 2024å¹´12æœˆ
**å¤ç°çŠ¶æ€**: âœ… æˆåŠŸå¤ç°è®ºæ–‡ç»“æœ

